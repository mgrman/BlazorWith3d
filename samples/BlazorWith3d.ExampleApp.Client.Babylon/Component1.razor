@using Microsoft.JSInterop
@inject IJSRuntime JsRuntime

<canvas @ref="_containerElementReference" class="my-component"  width="960" height="600" tabindex="-1">
    This component is defined in the <strong>BlazorWith3d.ExampleApp.Client.Babylon</strong> library.
</canvas>


@code{

    private ElementReference _containerElementReference;
    private IJSObjectReference module;
    private IJSObjectReference _babylonApp;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender)
        {
            await base.OnAfterRenderAsync(firstRender);
            return;
        }


        var moduleTask = new Lazy<Task<IJSObjectReference>>(() => JsRuntime.InvokeAsync
        <IJSObjectReference>
            ("import", Assets["./_content/BlazorWith3d.ExampleApp.Client.Babylon/assets/index.js"]).AsTask());
        
        module = await moduleTask.Value;
        
        
        _babylonApp = await module.InvokeAsync<IJSObjectReference>("Initialize", _containerElementReference);


        await base.OnAfterRenderAsync(firstRender);
    }
}

           